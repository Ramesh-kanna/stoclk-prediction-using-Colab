# -*- coding: utf-8 -*-
"""Untitled1.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1M4mjAkX4-4LW3b2Ghh4T-6GcVVgbsu7m
"""

#Import the libraries
import pandas as pd
import xgboost as xgb
import matplotlib.pyplot as plt

#Load the data S&P500
data = pd.read_csv('SPY.csv')
#Show the data
data

#Show the data visually
data['Close'].plot()

#Split the data into training and testing datta sets
train_data = data.iloc[:int(.99*len(data)), :]
test_data = data.iloc[:int(.99*len(data)), :]

#Define the features and target variable
features = ['Open', 'Volume']
target = 'Close'

#Create and train the model
model = xgb.XGBRegressor()
model.fit(train_data[features], train_data[target])

#Make and show the predictions on the test data
predictions = model.predict(test_data[features])
print('Model Predictions:')
print(predictions)

#Show the actual values
print('Actual Values:')
print(test_data[target])

#Show the models accuracy
accuracy = model.score(test_data[features], test_data[target])
print('Accuracy:')
print(accuracy)

#Plot the predictions and the close price
plt.plot(data['Close'], label = 'Close Price')
plt.plot(test_data[target].index, predictions, label = 'Predictions')
plt.show()